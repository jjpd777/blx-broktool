angular.module("RDash",["ui.bootstrap","ui.router","ngCookies","ngStorage","cp.ngConfirm","tableSort","ui.select","chart.js","cp.ngConfirm"]);
"use strict";angular.module("RDash").config(["$stateProvider","$urlRouterProvider",function(t,l){l.otherwise("/login"),t.state("login",{url:"/login",controller:"AuthCtrl",templateUrl:"templates/login.html"}).state("app",{url:"/app",controller:"MasterCtrl",templateUrl:"templates/app/app.html"}).state("app.usuarios",{url:"/usuarios",controller:"usuariosCtrl",templateUrl:"templates/app/usuarios/usuarios.html"}).state("app.pagos",{url:"/pagos",controller:"pagosCtrl",templateUrl:"templates/app/pagos/pagos.html"}).state("app.historico",{url:"/historico",controller:"historicoCtrl",templateUrl:"templates/app/historico/historico.html"}).state("app.dashboard",{url:"/dashboard",controller:"dashboardCtrl",templateUrl:"templates/app/Dashboard/dashboard.html"}).state("app.pos",{url:"/pos",controller:"posCtrl",templateUrl:"templates/app/pos/pos.html"})}]);
function rdLoading(){return{restrict:"AE",template:'<div class="loading"><div class="double-bounce1"></div><div class="double-bounce2"></div></div>'}}angular.module("RDash").directive("rdLoading",rdLoading);
function rdWidgetBody(){return{requires:"^rdWidget",scope:{loading:"=?",classes:"@?"},transclude:!0,template:'<div class="widget-body" ng-class="classes"><rd-loading ng-show="loading"></rd-loading><div ng-hide="loading" class="widget-content" ng-transclude></div></div>',restrict:"E"}}angular.module("RDash").directive("rdWidgetBody",rdWidgetBody);
function rdWidgetFooter(){return{requires:"^rdWidget",transclude:!0,template:'<div class="widget-footer" ng-transclude></div>',restrict:"E"}}angular.module("RDash").directive("rdWidgetFooter",rdWidgetFooter);
function rdWidgetTitle(){return{requires:"^rdWidget",scope:{title:"@",icon:"@"},transclude:!0,template:'<div class="widget-header"><div class="row"><div class="pull-left"><i class="fa" ng-class="icon"></i> {{title}} </div><div class="pull-right col-xs-6 col-sm-4" ng-transclude></div></div></div>',restrict:"E"}}angular.module("RDash").directive("rdWidgetHeader",rdWidgetTitle);
function rdWidget(){return{transclude:!0,template:'<div class="widget" ng-transclude></div>',restrict:"EA"}}angular.module("RDash").directive("rdWidget",rdWidget);
function AlertsCtrl(e){e.alerts=[{type:"success",msg:"Thanks for visiting! Feel free to create pull requests to improve the dashboard!"},{type:"danger",msg:"Found a bug? Create an issue with as many details as you can."}],e.addAlert=function(){e.alerts.push({msg:"Another alert!"})},e.closeAlert=function(t){e.alerts.splice(t,1)}}angular.module("RDash").controller("AlertsCtrl",["$scope",AlertsCtrl]);
function AuthCtrl(o,t,r,u,a,e,s,l){l.urlMain="http://gyo-solutions.com/dev_brokers_network/php/admin/",o.user={usuario:"",pass:""},o.doLogin=function(){a.go("app.usuarios")}}angular.module("RDash").controller("AuthCtrl",["$scope","$cookieStore","$localStorage","$http","$state","$timeout","auth","$rootScope",AuthCtrl]);
function dashboardCtrl(s,e,a,r){s.error={status:!1,mensaje:""},s.success={status:!1,mensaje:""},s.search="",s.show_success=function(e){s.success.status=!0,s.success.mensaje=e,a(function(){s.error={status:!1,mensaje:""},s.success={status:!1,mensaje:""}},2e3)},s.show_error=function(e){s.error.status=!0,s.error.mensaje=e,a(function(){s.error={status:!1,mensaje:""},s.success={status:!1,mensaje:""}},2e3)},s.getDatos=function(){s.labelsBar=["2006","2007","2008","2009","2010","2011","2012"],s.seriesBar=["Series A","Series B"],s.dataBar=[[65,59,80,81,56,55,40],[28,48,40,19,86,27,90]],s.labelsPie=["Download Sales","In-Store Sales","Mail-Order Sales"],s.dataPie=[300,500,100]},s.getDatos()}angular.module("RDash").controller("dashboardCtrl",["$scope","$uibModal","$timeout","auth",dashboardCtrl]);
function historicoCtrl(e,s,t,a,r,o){e.error={status:!1,mensaje:""},e.success={status:!1,mensaje:""},e.search="",e.usuario={usuario:"",pass:"",pass2:""},e.show_success=function(s){e.success.status=!0,e.success.mensaje=s,t(function(){e.error={status:!1,mensaje:""},e.success={status:!1,mensaje:""}},2e3)},e.show_error=function(s){e.error.status=!0,e.error.mensaje=s,t(function(){e.error={status:!1,mensaje:""},e.success={status:!1,mensaje:""}},2e3)},e.getPagos=function(){a.getPagos().then(function(s){e.pagos=s.data})},e.getPagos(),e.validarEntrega=function(s,t){e.usuarioS=s;var r="btn-success",n="Se entregará el producto #{{usuarioS.id_pago}} de {{usuarioS.producto}}",c="Entrega de producto validada correctamente",u="Error al validar entrega",i="Entregar";"CANCELADO"==t&&(r="btn-red",n="Se cancelará el producto #{{usuarioS.id_pago}} de {{usuarioS.producto}}",c="Entrega de producto cancelada correctamente",u="Error al cancelar entrega",i="Cancelar"),console.log(s),o({title:"Atención!",content:n,scope:e,buttons:{aceptar:{text:i,btnClass:r,action:function(r,o){return a.validarEntrega(s,t).then(function(s){"1"===s.data?(e.show_success(c),e.getPagos()):e.show_error(u)}),!0}},close:{text:"Cancelar",btnClass:"btn-blue",action:function(e,s){}}}})}}angular.module("RDash").controller("historicoCtrl",["$scope","$uibModal","$timeout","pagos","auth","$ngConfirm",historicoCtrl]);
function MasterCtrl(e,r,t,o,s,a,n,u){u.urlMain="http://gyo-solutions.com/dev_brokers_network/php/admin/",e.salir=function(){t.logged=!1,t.user=null,e.logged=!1,e.user=null,s.go("login")},e.user=t.user;e.getWidth=function(){return window.innerWidth},e.$watch(e.getWidth,function(t,o){t>=992?angular.isDefined(r.get("toggle"))?e.toggle=!!r.get("toggle"):e.toggle=!0:e.toggle=!1}),e.editarPerfil=function(){console.log("user",e.user),e.user.pass2="";a({title:"Editar Perfil",content:'<form><label>Usuario:</label><input type="text" class="form-control" ng-model="user.usuario"/><label>Contraseña:</label><input type="password" class="form-control" ng-model="user.pass"/><label>Confirmar Contraseña:</label><input type="password" class="form-control" ng-model="user.pass2"/></form>',scope:e,theme:"supervan",buttons:{confirmar:{text:"Confirmar",btnClass:"btn-blue",action:function(r,t){return""===e.user.pass2?n.editarUsuario(e.user.id_usuario,e.user.usuario,e.user.pass).then(function(e){if("1"===e.data)return!1;alert("Error al edit usuario")}):e.user.pass===e.user.pass2&&n.editarUsuario(e.user.id_usuario,e.user.usuario,e.user.pass).then(function(e){if("1"===e.data)return!1;alert("Error al edit usuario")}),!0}},cancelar:{text:"Cancelar",btnClass:"btn-warning",action:function(e,r){return!0}}}})},e.toggleSidebar=function(){e.toggle=!e.toggle,r.put("toggle",e.toggle)},window.onresize=function(){e.$apply()}}angular.module("RDash").controller("MasterCtrl",["$scope","$cookieStore","$localStorage","$http","$state","$ngConfirm","usuarios","$rootScope",MasterCtrl]);
function pagosCtrl(e,a,s,t,r,o){e.error={status:!1,mensaje:""},e.success={status:!1,mensaje:""},e.search="",e.usuario={usuario:"",pass:"",pass2:""},e.show_success=function(a){e.success.status=!0,e.success.mensaje=a,s(function(){e.error={status:!1,mensaje:""},e.success={status:!1,mensaje:""}},2e3)},e.show_error=function(a){e.error.status=!0,e.error.mensaje=a,s(function(){e.error={status:!1,mensaje:""},e.success={status:!1,mensaje:""}},2e3)},e.getPagos=function(){t.getPagos().then(function(a){e.pagos=a.data})},e.getPagos(),e.validarEntrega=function(a,s){e.usuarioS=a;var r="btn-success",n="Se entregará el producto #{{usuarioS.id_pago}} de {{usuarioS.producto}}",c="Entrega de producto validada correctamente",u="Error al validar entrega",i="Entregar";"CANCELADO"==s&&(r="btn-red",n="Se cancelará el producto #{{usuarioS.id_pago}} de {{usuarioS.producto}}",c="Entrega de producto cancelada correctamente",u="Error al cancelar entrega",i="Cancelar"),console.log(a),o({title:"Atención!",content:n,scope:e,buttons:{aceptar:{text:i,btnClass:r,action:function(r,o){return t.validarEntrega(a,s).then(function(a){"1"===a.data?(e.show_success(c),e.getPagos()):e.show_error(u)}),!0}},close:{text:"Cancelar",btnClass:"btn-blue",action:function(e,a){}}}})}}angular.module("RDash").controller("pagosCtrl",["$scope","$uibModal","$timeout","pagos","auth","$ngConfirm",pagosCtrl]);
function posCtrl(o,e,t,a){o.error={status:!1,mensaje:""},o.success={status:!1,mensaje:""},o.search="",o.show_success=function(e){o.success.status=!0,o.success.mensaje=e,t(function(){o.error={status:!1,mensaje:""},o.success={status:!1,mensaje:""}},2e3)},o.show_error=function(e){o.error.status=!0,o.error.mensaje=e,t(function(){o.error={status:!1,mensaje:""},o.success={status:!1,mensaje:""}},2e3)},o.search="",o.prod={selected:{}},o.formasPago=["Efectivo","Tarjeta","Cheque"],o.error={status:!1,mensaje:""},o.success={status:!1,mensaje:""},o.producto={nombre:"",descripcion:"",precio:0,cantidad:1},o.corte={pagos:{},ingresos:{}},o.desgloce=[],o.conceptos=[],o.alumnos=[],o.productos=[],o.productos_temp=[],o.conceptos_temp=[],o.pago={conceptos:[],total:0,forma_pago:"Efectivo",comentarios:""},o.abrirNewProducto=function(){o.modalInstance=e.open({animation:o.animationsEnabled,templateUrl:"templates/app/pos/crear.html",size:"lg",controller:["$scope","$uibModalInstance",function(o,e){o.mensaje={status:1,mensaje:""},o.agregarProducto=function(){$http({method:"POST",url:"http://localhost/ipefh-panel/PHP/admin/Productos/agregarProductos.php",processData:!1,transformRequest:function(e){var t=new FormData;return t.append("nombre",o.producto.nombre),t.append("descripcion",o.producto.descripcion),t.append("precio",o.producto.precio),t},headers:{"Content-Type":void 0}}).then(function(t){"1"===t.data?(o.mensaje.mensaje="Se ha creado correctamente el producto",o.mensaje.status=1,e.close(o.mensaje)):(o.mensaje.mensaje="Error al crear el producto",o.mensaje.status=0,e.close(o.mensaje))})},o.cancel=function(){e.close()}}]}),o.modalInstance.result.then(function(e){void 0!==e&&(1===e.status?o.show_success(e.mensaje):o.show_error(e.mensaje)),o.getProductos()},function(){})},o.abrirVerProducto=function(t){e.open({animation:o.animationsEnabled,templateUrl:"templates/app/pos/ver.html",size:"lg",controller:["$scope","$uibModalInstance","producto",function(o,e,t){o.mensaje={status:1,mensaje:""},o.producto=t,o.editarProducto=function(){$http({method:"POST",url:"http://localhost/ipefh-panel/PHP/admin/Productos/editarProductos.php",processData:!1,transformRequest:function(e){var t=new FormData;return t.append("id_producto",o.producto.id_producto),t.append("nombre",o.producto.nombre),t.append("descripcion",o.producto.descripcion),t.append("precio",o.producto.precio),t},headers:{"Content-Type":void 0}}).then(function(t){"1"===t.data?(o.mensaje.mensaje="Se ha editado correctamente el producto",o.mensaje.status=1,e.close(o.mensaje)):(o.mensaje.mensaje="Error al editar el producto",o.mensaje.status=0,e.close(o.mensaje))})}}],resolve:{producto:function(){return t}}}).result.then(function(e){1===e.status?o.show_success(e.mensaje):o.show_error(e.mensaje),o.getProductos()},function(){})},o.toggleAnimation=function(){o.animationsEnabled=!o.animationsEnabled},o.agregarConceptoPago=function(){""!==o.producto.nombre&&""!==o.producto.descripcion&&0!==o.producto.precio&&(o.pago.conceptos.push(angular.copy(o.producto)),o.actualizarTotalPago(),o.producto={nombre:"",descripcion:"",precio:0,cantidad:1})},o.quitarConceptoPago=function(e){o.pago.conceptos.forEach(function(t,a){t.id_producto===e.id_producto&&(o.pago.conceptos.splice(a,1),o.conceptos_temp.push(e))}),o.actualizarTotal()},o.actualizarTotalPago=function(){o.pago.total=0,o.pago.conceptos.length>0&&o.pago.conceptos.forEach(function(e){o.pago.total+=parseInt(e.precio)*e.cantidad})}}angular.module("RDash").controller("posCtrl",["$scope","$uibModal","$timeout","auth",posCtrl]);
function usuariosCtrl(s,e,a,u,o,r){s.error={status:!1,mensaje:""},s.success={status:!1,mensaje:""},s.search="",s.usuario={usuario:"",pass:"",pass2:""},s.show_success=function(e){s.success.status=!0,s.success.mensaje=e,a(function(){s.error={status:!1,mensaje:""},s.success={status:!1,mensaje:""}},2e3)},s.show_error=function(e){s.error.status=!0,s.error.mensaje=e,a(function(){s.error={status:!1,mensaje:""},s.success={status:!1,mensaje:""}},2e3)},s.getUsuarios=function(){u.getUsuarios().then(function(e){console.log(e.data),s.usuarios=e.data})},s.abrirNewUsuario=function(){s.modalInstance=e.open({animation:s.animationsEnabled,templateUrl:"templates/app/usuarios/crear.html",size:"lg",controller:["$scope","$uibModalInstance","usuarios",function(s,e,a){s.mensaje={status:1,mensaje:""},s.agregarUsuario=function(){s.usuario.pass===s.usuario.pass2?a.agregarUsuario(s.usuario.usuario,s.usuario.pass,JSON.stringify(s.usuario.permisos)).then(function(a){"1"===a.data?(s.mensaje.mensaje="Se ha creado correctamente el usuario",s.mensaje.status=1,e.close(s.mensaje)):(s.mensaje.mensaje="Error al crear el usuario",s.mensaje.status=0,e.close(s.mensaje))}):alert("Las contraseñas debe coincidir!")},s.cancel=function(){e.close()}}]}),s.modalInstance.result.then(function(e){void 0!==e&&(1===e.status?s.show_success(e.mensaje):s.show_error(e.mensaje)),s.getUsuarios()},function(){})},s.abrirVerUsuario=function(a){e.open({animation:s.animationsEnabled,templateUrl:"templates/app/usuarios/ver.html",size:"lg",controller:["$scope","$uibModalInstance","usuario",function(s,e,a){s.mensaje={status:1,mensaje:""},s.usuario=a,s.checkModel={usuario:!1,admin:!1,superadmin:!1},s.checkResults=[],s.editarUsuario=function(){void 0!==s.usuario.pass2?s.usuario.pass===s.usuario.pass2?u.editarUsuario(s.usuario.id_usuario,s.usuario.usuario,s.usuario.pass).then(function(a){"1"===a.data?(s.mensaje.mensaje="Se ha editado correctamente el usuario",s.mensaje.status=1,e.close(s.mensaje)):(s.mensaje.mensaje="Error al editar el usuario",s.mensaje.status=0,e.close(s.mensaje))}):alert("Las contraseñas debe coincidir!"):u.editarUsuario(s.usuario.id_usuario,s.usuario.usuario,s.usuario.pass).then(function(a){"1"===a.data?(s.mensaje.mensaje="Se ha editado correctamente el usuario",s.mensaje.status=1,e.close(s.mensaje)):(s.mensaje.mensaje="Error al editar el usuario",s.mensaje.status=0,e.close(s.mensaje))})},s.cancel=function(){e.close()}}],resolve:{usuario:function(){return a}}}).result.then(function(e){void 0!==e&&(1===e.status?s.show_success(e.mensaje):s.show_error(e.mensaje)),s.getUsuarios()},function(){})},s.eliminarUsuario=function(e){s.usuarioS=e,console.log(e),r({title:"Atención!",content:"Se eliminará el usuario {{usuarioS.usuario}}",scope:s,buttons:{aceptar:{text:"Eliminar",btnClass:"btn-red",action:function(a,o){return u.eliminarUsuario(e).then(function(e){console.log("Eliminar usuario",e),"1"===e.data?(s.show_success("Usuario eliminado correctamente"),s.getUsuarios()):s.show_error("Error al eliminar usuario")}),!0}},close:{text:"Cancelar",btnClass:"btn-blue",action:function(s,e){}}}})},s.getUsuarios()}angular.module("RDash").controller("usuariosCtrl",["$scope","$uibModal","$timeout","usuarios","auth","$ngConfirm",usuariosCtrl]);
function authFactory(o,e,n,t){var a={};return a.doLogin=function(e,n){return o({method:"POST",url:"http://localhost/admin-template/PHP/admin/Auth/doLogin.php",processData:!1,transformRequest:function(o){var t=new FormData;return t.append("usuario",e),t.append("pass",n),t},headers:{"Content-Type":void 0}})},a.checkSession=function(){console.log("checking session...");var o=n.user;null!==o&&void 0!==o&&n.logged?(console.log("Welcome"),a.doLogin(o.usuario,o.pass)):(console.log("Not signed in"),t.go("login"))},a}angular.module("RDash").factory("auth",["$http","$cookieStore","$localStorage","$state",authFactory]);
function pagosFactory(a,t){var r={};return r.getPagos=function(){return a({method:"POST",url:t.urlMain+"Pagos/getPagos.php",processData:!1,transformRequest:function(a){return new FormData},headers:{"Content-Type":void 0}})},r.validarEntrega=function(r,o){return a({method:"POST",url:t.urlMain+"Pagos/validarEntrega.php",processData:!1,transformRequest:function(a){var t=new FormData;return t.append("id_pago",r.id_pago),t.append("txt",o),t},headers:{"Content-Type":void 0}})},r}angular.module("RDash").factory("pagos",["$http","$rootScope",pagosFactory]);
function usuariosFactory(r,a){var e={};return e.getUsuarios=function(){return r({method:"POST",url:a.urlMain+"Usuarios/getUsuarios.php",processData:!1,transformRequest:function(r){return new FormData},headers:{"Content-Type":void 0}})},e.agregarUsuario=function(a,e,o){return r({method:"POST",url:urlUsuarios+"agregarUsuario.php",processData:!1,transformRequest:function(r){var u=new FormData;return u.append("usuario",a),u.append("pass",e),u.append("permisos",o),u},headers:{"Content-Type":void 0}})},e.editarUsuario=function(a,e,o){return r({method:"POST",url:urlUsuarios+"editarUsuario.php",processData:!1,transformRequest:function(r){var u=new FormData;return u.append("id_usuario",a),u.append("usuario",e),u.append("pass",o),u},headers:{"Content-Type":void 0}})},e.eliminarUsuario=function(a){return r({method:"POST",url:urlUsuarios+"eliminarUsuario.php",processData:!1,transformRequest:function(r){var e=new FormData;return e.append("id_usuario",a.id_usuario),e},headers:{"Content-Type":void 0}})},e}angular.module("RDash").factory("usuarios",["$http","$rootScope",usuariosFactory]);